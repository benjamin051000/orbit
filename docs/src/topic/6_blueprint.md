# Blueprint

Orbit acts a front-end package manager. With Orbit alone, it can move and organize projects and files. HDL development can consist of complex workflows and tools to perform a variety of tasks such as synthesis, verification, and hardware-in-the-loop testing. 

With this in mind, Orbit is designed to be a frontend to all backends. It achieves this through a special output file called `blueprint.tsv`. The blueprint can be considered the link between Orbit's package management to any backend tool/build system.

The blueprint is placed in the current working IP's build directory.

## Specification

The blueprint is broken into a series of _rules_ on every line.
```
RULE
RULE
RULE
...
```

A _rule_ defines the _fileset_, _identifier_, and _filepath_ needed to build the current design.
```
RULE ::= <FILESET><TAB><IDENTIFIER><TAB><FILEPATH>
```

> __Note:__ A literal tab character `\t` is used as \<TAB>.

The _fileset_ is the name for a group of files to be commonly collected.

The _identifier_ can be 2 different values depending on the fileset context.

The _filepath_ is the absolute path to the file found for the given fileset.

_example `blueprint.tsv` for a comparator IP:_
``` 
XSIM-WCFG	comparator_tb	C:/users/kepler/develop/hdl/comparator/sim/wf/comparator_tb.wcfg
PY-MODEL	comparator_tb	C:/users/kepler/develop/hdl/comparator/sim/model/comparator_tb.py
VHDL-RTL	work	C:/users/kepler/develop/hdl/comparator/rtl/constants_pkg.vhd
VHDL-RTL	rary	C:/Users/kepler/.orbit/cache/gates-0.1.0-aac9110085/rtl/and_gate.vhd
VHDL-RTL	work	C:/users/kepler/develop/hdl/comparator/rtl/comparator.vhd
VHDL-SIM	work	C:/users/kepler/develop/hdl/comparator/sim/comparator_tb.vhd
```

## Filesets

A fileset's name is normalized to ALL-UPPERCASE-WITH-HYPHENS-NOT-UNDERSCORES. This makes it consistent across plugins when reading the `blueprint.tsv`.

_example fileset name normalization:_
```
py_model --{normalization}-> PY-MODEL
```

### Built-in Filesets

Built-in filesets are called __HDL filesets__. These currently include: 
- VHDL-RTL
- VHDL-SIM

A file grouped under VHDL-SIM has an entity declaration with zero ports declared. All other VHDL files ending in .vhd or .vhdl are considered VHDL-RTL.

The rules for HDL filesets are in-order, meaning the entire design hierarchy tree was generated by Orbit to determine the topological sorting of the required files.

> __Note:__ VLOG-RTL and VLOG-SIM are planned to be implemented in the future. Their behavior is similiar to VHDL-RTL and VHDL-SIM, but for Verilog files.


## Identifiers

### HDL filesets

If the fileset is an HDL fileset, then the identifier is the HDL library for the particular file. All files belonging to the current working IP will automatically be identified under
the library `work`.

### Supportive filesets

If the fileset is user-defined (not an HDL fileset), then the identifier is the
file's name.

## Filepaths

The filepath is the absolute path to the file collected under the given fileset. The filepath can be used in a plugin for further processing.